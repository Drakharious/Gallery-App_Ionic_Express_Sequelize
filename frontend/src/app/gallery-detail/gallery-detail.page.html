<ion-header class="ion-no-border">
  <ion-toolbar class="glass-toolbar">
    <ion-buttons slot="start">
      <ion-button (click)="goBack()">
        <ion-icon name="arrow-back" class="back-icon"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title class="futuristic-title">{{ gallery?.name }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="futuristic-bg">
  
  <div class="content-wrapper">
    
    <!-- Empty State -->
    <div *ngIf="!loading && images.length === 0" class="empty-state">
      <div class="empty-icon-wrapper">
        <ion-icon name="image-outline" class="empty-icon"></ion-icon>
      </div>
      <h2 class="empty-title">Sin imágenes</h2>
      <p class="empty-text">Sube tu primera imagen a esta galería</p>
      <ion-button class="upload-btn" (click)="uploadImage()">
        <ion-icon slot="start" name="cloud-upload-outline"></ion-icon>
        Subir Imagen
      </ion-button>
    </div>

    <!-- Images Grid -->
    <div *ngIf="images.length > 0" class="images-grid">
      <div class="image-card" *ngFor="let image of images; let i = index" (click)="viewImage(i)">
        <div class="card-glow"></div>
        <img [src]="getImageUrl(image.imageFile)" [alt]="image.name" class="image-content" />
        <div class="image-overlay">
          <h4 class="image-name">{{ image.name }}</h4>
          <p class="image-desc" *ngIf="image.description">{{ image.description }}</p>
        </div>
        <ion-button fill="clear" class="menu-btn" (click)="openImageMenu(image, $event)">
          <ion-icon slot="icon-only" name="ellipsis-vertical"></ion-icon>
        </ion-button>
      </div>
    </div>

  </div>

  <!-- Image Viewer -->
  <div class="image-viewer" *ngIf="showViewer" (click)="closeViewer()">
    <div class="viewer-content" (click)="$event.stopPropagation()">
      <ion-button fill="clear" class="nav-btn prev-btn" *ngIf="selectedImageIndex > 0" (click)="prevImage()">
        <ion-icon slot="icon-only" name="chevron-back"></ion-icon>
      </ion-button>
      
      <div class="viewer-image-wrapper">
        <img [src]="getImageUrl(currentImage.imageFile)" [alt]="currentImage.name" class="viewer-image" />
        <div class="viewer-info">
          <h3>{{ currentImage.name }}</h3>
          <p *ngIf="currentImage.description">{{ currentImage.description }}</p>
        </div>
      </div>
      
      <ion-button fill="clear" class="nav-btn next-btn" *ngIf="selectedImageIndex < images.length - 1" (click)="nextImage()">
        <ion-icon slot="icon-only" name="chevron-forward"></ion-icon>
      </ion-button>
    </div>
  </div>

  <!-- FAB Button -->
  <ion-fab vertical="bottom" horizontal="end" slot="fixed" *ngIf="images.length > 0">
    <ion-fab-button class="fab-futuristic" (click)="uploadImage()">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>

</ion-content>
