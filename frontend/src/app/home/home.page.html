<ion-header class="ion-no-border">
  <ion-toolbar class="glass-toolbar">
    <ion-title class="futuristic-title">
      <ion-icon name="images-outline" class="title-icon"></ion-icon>
      Mis Galerías
    </ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="goToProfile()">
        <ion-icon name="person-circle-outline" class="user-icon"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="futuristic-bg">
  
  <div class="content-wrapper">
    
    <div class="filter-section" *ngIf="categories.length > 0">
      <ion-button fill="clear" class="scroll-arrow" (click)="scrollCategories('left')" *ngIf="showLeftArrow">
        <ion-icon slot="icon-only" name="chevron-back"></ion-icon>
      </ion-button>
      <div class="segment-wrapper" #segmentWrapper (scroll)="onSegmentScroll()">
        <ion-segment [value]="selectedCategoryId" (ionChange)="filterByCategory($event.detail.value)" class="category-segment" scrollable>
          <ion-segment-button value="null">
            <ion-label>Todas</ion-label>
          </ion-segment-button>
          <ion-segment-button *ngFor="let category of categories" [value]="category.id">
            <ion-label>{{ category.name }}</ion-label>
          </ion-segment-button>
        </ion-segment>
      </div>
      <ion-button fill="clear" class="scroll-arrow" (click)="scrollCategories('right')" *ngIf="showRightArrow">
        <ion-icon slot="icon-only" name="chevron-forward"></ion-icon>
      </ion-button>
      <ion-button fill="clear" class="manage-categories-btn" (click)="goToCategories()">
        <ion-icon slot="icon-only" name="settings-outline"></ion-icon>
      </ion-button>
    </div>

    <ion-button *ngIf="categories.length === 0" expand="block" fill="outline" class="categories-link" (click)="goToCategories()">
      <ion-icon slot="start" name="folder-outline"></ion-icon>
      Gestionar Categorías
    </ion-button>
    
    <!-- Empty State -->
    <div *ngIf="!loading && galleries.length === 0" class="empty-state">
      <div class="empty-icon-wrapper">
        <ion-icon name="images-outline" class="empty-icon"></ion-icon>
      </div>
      <h2 class="empty-title">No tienes galerías</h2>
      <p class="empty-text">Crea tu primera galería para comenzar a organizar tus imágenes</p>
      <ion-button class="create-btn" (click)="createGallery()">
        <ion-icon slot="start" name="add-circle-outline"></ion-icon>
        Crear Galería
      </ion-button>
    </div>

    <!-- Galleries Grid -->
    <div *ngIf="galleries.length > 0" class="galleries-container">
      <div class="gallery-card" *ngFor="let gallery of galleries" (click)="openGallery(gallery.id)">
        <div class="card-glow"></div>
        <div class="card-content">
          <div class="gallery-preview">
            <ion-icon *ngIf="!getCoverImage(gallery)" name="image-outline" class="preview-icon"></ion-icon>
            <img *ngIf="getCoverImage(gallery)" 
                 [src]="'http://localhost:8080/uploads/' + getCoverImage(gallery)" 
                 class="preview-img" />
          </div>
          <div class="gallery-info">
            <h3 class="gallery-name">{{ gallery.name }}</h3>
            <p class="gallery-count">{{ gallery.images?.length || 0 }} imágenes</p>
          </div>
          <ion-button fill="clear" class="menu-btn" (click)="openGalleryMenu(gallery, $event)">
            <ion-icon slot="icon-only" name="ellipsis-vertical"></ion-icon>
          </ion-button>
        </div>
      </div>
    </div>

  </div>

  <!-- FAB Button -->
  <ion-fab vertical="bottom" horizontal="end" slot="fixed" *ngIf="galleries.length > 0">
    <ion-fab-button class="fab-futuristic" (click)="createGallery()">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>

</ion-content>
